---
title: "Annotation Report of query genome `r params$query`"
author: "Felipe M. Almeida <falmeida@aluno.unb.br>"
date: "`r format(Sys.time(), '%d %B %Y')`"
subtitle: "Virulence genes annotated from VFDB"
params:
  blast_id:
  blast_cov:
  vfdb_blast:
  query:
  gff:
output:
  bookdown::html_document2:
    df_print: paged
    number_sections: false
    syntax: tango
    self_contained: yes
    theme: journal
---

<style type="text/css">

body{ /* Normal  */
      font-size: 16px;
  }
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, fig.pos = 'H')
options(knitr.table.format = "html")
bt_opt =  c("hover", "condensed", "responsive")
library(magrittr)
library(knitr)
library(tidyr)
library(plyr)
library(kableExtra)
library(dplyr)
library(stringr)
library(ggplot2)
#victors_blast <- read.delim(params$victors_blast)
vfdb_blast <- try(read.delim(params$vfdb_blast, header = FALSE), silent = TRUE)
gff_blast <- try(read.delim(params$gff, header = FALSE), silent = TRUE)

# Check if blast is empty
if (class(vfdb_blast) != 'try_error' & nrow(vfdb_blast) > 0) {
  vfdb_not_null <- TRUE
  vfdb_null <- FALSE
} else {
  vfdb_not_null <- FALSE
  vfdb_null <- TRUE
}
```

# About

Virulence factors are molecules produced by bacteria that add effectiveness in their colonization of a niche, immunoevasion, immunosuppression and obtain nutrition from the host.

[VFDB](http://www.mgc.ac.cn/VFs/main.htm) (Virulence Factor Database) is a comprehensive resource, created in 2004, of curated information about virulence factors of pathogenic bacteria. To date, it contains a 1080 virulence factors in its database, from 74 _bacteria genera_.

[VFDB](http://www.mgc.ac.cn/VFs/main.htm) database was blasted via BLASTx, using the thresholds below. This report summarizes its results.

* Blast % identity: `> `r params$blast_id`%`
* Blast % query coverage: `> `r params$blast_cov`%`

# Results

```{r, VFDB_conditional_block, echo=FALSE, results='asis', eval=vfdb_not_null, child='yes_vfdb.Rmd'}
```

```{r, VFDB_conditional_block_2, echo=FALSE, results='asis', eval=vfdb_null, child='no_vfdb.Rmd'}
```
