### Perfect Hits

Perfect hits are genes that CARD guarantee its functionality. Which means that these genes are likely functional and might be conferring resistance to the bacteria. A summary of the Antibiotic Classes target by ARGs annotated as Perfect hits is shown in Figure \@ref(fig:rgi-perfect-resistome-png).

```{r rgi-perfect-resistome-png, fig.align='center', fig.show='hold', fig.cap="Resistome Predicted using CARD RGI tool", out.width="60%"}
rgi_count <- rgi_perfect %>%
  separate_rows(`Drug Class`, sep = "; ") %>%
  select(`Protein ID`,`Drug Class`)
colnames(rgi_count) <- c("Contig", "Class")
drugs <- plyr::count(rgi_count, "Class")
ggplot(drugs, aes(x=Class, y=freq, fill=Class)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()) +
  xlab("Targeted Drug Class") +
  ylab("Number of genes") +
  guides(fill=guide_legend(title = "Drug Classes"))
```

```{r results='asis'}
# Create List
#string.list <- rgi_perfect %>% separate_rows(`Drug Class`, sep = "; ") %>% pull(`Drug Class`) %>% sort() %>% unique()
#cat("- **Drug Classes targeted by the query genome:**\n")
#cat(paste("\t-", string.list), sep = '\n')
```

#### Supporting data

```{r rgi-perfect-resistance-genes}
# Produce Table
rgi_perfect %>%
  select("Gene","Resistance Mechanism", "Drug Class", "ARO", "CARD Link", "Query Protein Coordinates", "Description") %>%
  group_by(`Resistance Mechanism`) %>%
  arrange(`Gene`, `CARD Link`,`Resistance Mechanism`, `Drug Class`) %>%
  datatable(caption = "CARD resistance genes annotated and its target drug classes",
            colnames = c("Gene","Resistance Mechanism", "Drug Class", "ARO", "CARD Link", "Genome Coordinates", "Description"),
          escape = FALSE,
          rownames = FALSE,
          options = list(pageLength = 5))
```