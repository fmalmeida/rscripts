---
title: "CARD"
params:
  card_summary:
---
```{r}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, fig.pos = 'H')
card_summary <- read.delim(params$card_summary)
```

# CARD results

CARD is a curated database which hosts drug resistance genes of pathogenic bacteria. Therefore, an antibiogram can be infered using data provenient from this database.

In Table \@ref(tab:card-resistance-pattern) we can clearly see all resistance gene names found in the query genome and its target drug classes. In addition, each ARO accession are disponibilized to the user in order to gather more information about each gene. This ARO can be searched in CARD database.

In summary, the query genome possesses the following resistance genes: **`r card_summary %>% pull(Name)`**. And, these genes together confer resistance to the following drug classes: **`r card_summary %>% separate_rows(Drug_Class, sep = ":") %>% pull(Drug_Class) %>% unique()`**

In Figure \@ref(fig:card-resistome-png) it is summarised the amount of genes found that target a specific antibiotic class.


```{r card-resistome-png, fig.align='center', fig.show='hold', fig.cap="Drug Classes to which the query genome is resistant", out.width="60%"}
card_count <- card_summary %>%
  select("Name", "Drug_Class", "Resistance_Mechanism", "ARO_Accession") %>% separate_rows(Drug_Class, sep = ":") %>% group_by(Name)
drugs <- plyr::count(card_count, "Drug_Class")
ggplot(drugs, aes(x=Drug_Class, y=freq, fill=Drug_Class)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()) +
  xlab("Drug Classes") +
  ylab("Frequency") +
  guides(fill=guide_legend(title = "Drug Classes"))
```
